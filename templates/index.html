<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prompt Studio | Genesys Cloud</title>

    <!-- Genesys Spark Required Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Urbanist:wght@300;400;500;600;700;800&family=Noto+Sans:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Genesys Spark Components CSS -->
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/genesys-spark-components@4/dist/genesys-webcomponents/genesys-webcomponents.css">

    <!-- Genesys Spark Components JS -->
    <script type="module"
        src="https://cdn.jsdelivr.net/npm/genesys-spark-components@4/dist/genesys-webcomponents/genesys-webcomponents.esm.js"></script>

    <!-- Ionicons for additional icons -->
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>

    <!-- Custom Spark CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/spark.css') }}">


</head>

<body>
    <!-- Navigation -->
    <nav class="gux-nav">
        <div class="gux-nav-container">
            <a href="/" class="gux-nav-brand">
                <div class="gux-nav-logo">
                    <ion-icon name="mic-outline" style="font-size: 20px; color: white;"></ion-icon>
                </div>
                <span class="gux-nav-title">Prompt Studio</span>
                <span class="gux-nav-subtitle">Genesys Cloud</span>
            </a>

            <!-- User info and logout -->
            <div class="gux-nav-user">
                {% if user %}
                <div class="gux-user-info">
                    <ion-icon name="person-circle-outline"></ion-icon>
                    <span>{{ user.name or user.email or 'User' }}</span>
                </div>
                {% endif %}
                <a href="{{ url_for('logout') }}" class="gux-btn-logout">
                    <ion-icon name="log-out-outline"></ion-icon>
                    <span>Logout</span>
                </a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="gux-main">
        <!-- Hero Header -->
        <div class="gux-hero">
            <h1>Create Audio Prompts</h1>
            <p>Generate text-to-speech, record your voice, or import audio files and export directly to Genesys Cloud.
            </p>
        </div>

        <!-- Main Card -->
        <div class="gux-card">
            <!-- Tabs Header -->
            <div class="gux-tabs-header">
                <button class="gux-tab-btn active" data-tab="tts">
                    <ion-icon name="text-outline"></ion-icon>
                    <span>Text to Speech</span>
                </button>
                <button class="gux-tab-btn" data-tab="record">
                    <ion-icon name="mic-outline"></ion-icon>
                    <span>Record Audio</span>
                </button>
                <button class="gux-tab-btn" data-tab="import">
                    <ion-icon name="cloud-upload-outline"></ion-icon>
                    <span>Import File</span>
                </button>
                <button class="gux-tab-btn" data-tab="library">
                    <ion-icon name="library-outline"></ion-icon>
                    <span>Prompt Library</span>
                </button>
            </div>

            <!-- Tab: Text to Speech -->
            <div id="tts" class="gux-tab-content active">
                <div class="gux-form-group">
                    <label class="gux-label">Voice Selection</label>
                    <select id="voiceSelect" class="gux-select">
                        <optgroup label="English (US)">
                            <option value="en-US-JennyNeural">Jenny (Female, Neural)</option>
                            <option value="en-US-GuyNeural">Guy (Male, Neural)</option>
                            <option value="en-US-AriaNeural">Aria (Female, Neural)</option>
                            <option value="en-US-DavisNeural">Davis (Male, Neural)</option>
                        </optgroup>
                        <optgroup label="English (UK)">
                            <option value="en-GB-SoniaNeural">Sonia (Female, Neural)</option>
                            <option value="en-GB-RyanNeural">Ryan (Male, Neural)</option>
                        </optgroup>
                        <optgroup label="German">
                            <option value="de-DE-KatjaNeural">Katja (Female, Neural)</option>
                            <option value="de-DE-ConradNeural">Conrad (Male, Neural)</option>
                        </optgroup>
                        <optgroup label="French">
                            <option value="fr-FR-DeniseNeural">Denise (Female, Neural)</option>
                            <option value="fr-FR-HenriNeural">Henri (Male, Neural)</option>
                        </optgroup>
                        <optgroup label="Spanish">
                            <option value="es-ES-ElviraNeural">Elvira (Female, Neural)</option>
                            <option value="es-ES-AlvaroNeural">Alvaro (Male, Neural)</option>
                        </optgroup>
                    </select>
                </div>
                <div class="gux-form-group">
                    <label class="gux-label">Prompt Text</label>
                    <textarea id="ttsText" class="gux-textarea" rows="5"
                        placeholder="Enter the text you want to convert to speech..."></textarea>
                </div>
                <button class="gux-btn gux-btn-primary" id="generateBtn">
                    <span class="gux-spinner-inline"></span>
                    <ion-icon name="flash-outline"></ion-icon>
                    <span class="gux-btn-text">Generate Audio</span>
                </button>
            </div>

            <!-- Tab: Record Audio -->
            <div id="record" class="gux-tab-content">
                <div class="gux-record-container">
                    <div id="recordBtn" class="gux-record-btn">
                        <ion-icon name="mic-outline" style="font-size: 2.5rem;"></ion-icon>
                    </div>
                    <p class="gux-record-status" id="recordStatus">Click to start recording</p>
                </div>
            </div>

            <!-- Tab: Import File -->
            <div id="import" class="gux-tab-content">
                <div class="gux-drop-zone" id="dropZone">
                    <ion-icon name="cloud-upload-outline"></ion-icon>
                    <p>Drag & drop your WAV file here</p>
                    <p class="gux-drop-hint">or click to browse files</p>
                    <input type="file" id="fileInput" accept=".wav" style="display: none;">
                </div>
            </div>

            <!-- Tab: Prompt Library -->
            <div id="library" class="gux-tab-content">
                <!-- Search and Controls -->
                <div class="gux-library-controls">
                    <div class="gux-search-box">
                        <ion-icon name="search-outline"></ion-icon>
                        <input type="text" id="librarySearch" class="gux-input" placeholder="Search prompts by name...">
                    </div>
                    <button class="gux-btn gux-btn-secondary" id="refreshLibraryBtn">
                        <ion-icon name="refresh-outline"></ion-icon>
                        <span>Refresh</span>
                    </button>
                </div>

                <!-- Prompts List -->
                <div class="gux-prompts-container">
                    <div id="promptsLoading" class="gux-library-loading">
                        <div class="gux-spinner"></div>
                        <p>Loading prompts from Genesys Cloud...</p>
                    </div>

                    <div id="promptsEmpty" class="gux-library-empty" style="display: none;">
                        <ion-icon name="folder-open-outline"></ion-icon>
                        <p>No prompts found</p>
                        <p class="gux-hint">Create prompts using the other tabs or adjust your search</p>
                    </div>

                    <table id="promptsTable" class="gux-table" style="display: none;">
                        <thead>
                            <tr>
                                <th class="sortable" data-sort="name">
                                    Name
                                    <ion-icon name="chevron-up-outline" class="sort-icon"></ion-icon>
                                </th>
                                <th>Description</th>
                                <th>Languages</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="promptsTableBody">
                            <!-- Prompts will be inserted here -->
                        </tbody>
                    </table>
                </div>

                <!-- Pagination -->
                <div id="promptsPagination" class="gux-pagination" style="display: none;">
                    <button class="gux-btn gux-btn-sm" id="prevPageBtn" disabled>
                        <ion-icon name="chevron-back-outline"></ion-icon>
                        Previous
                    </button>
                    <span id="paginationInfo" class="gux-pagination-info">Page 1 of 1</span>
                    <button class="gux-btn gux-btn-sm" id="nextPageBtn" disabled>
                        Next
                        <ion-icon name="chevron-forward-outline"></ion-icon>
                    </button>
                </div>

                <!-- Library Audio Player (shown when playing a prompt) -->
                <div id="libraryPlayerSection" class="gux-library-player" style="display: none;">
                    <div class="gux-section-title">
                        <ion-icon name="musical-notes-outline"></ion-icon>
                        <span id="libraryPlayerTitle">Now Playing</span>
                    </div>
                    <div class="gux-library-player-content">
                        <div class="gux-language-selector">
                            <label class="gux-label">Language:</label>
                            <select id="libraryLanguageSelect" class="gux-select gux-select-sm"></select>
                        </div>
                        <div class="gux-audio-player">
                            <div id="libraryWaveform"></div>
                            <div class="gux-player-controls">
                                <button class="gux-play-btn" id="libraryPlayBtn">
                                    <ion-icon name="play" style="font-size: 1.5rem; margin-left: 3px;"></ion-icon>
                                </button>
                                <button class="gux-btn gux-btn-secondary gux-btn-sm" id="transcribeBtn">
                                    <span class="gux-spinner-inline"></span>
                                    <ion-icon name="text-outline"></ion-icon>
                                    <span class="gux-btn-text">Transcribe & Translate</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Transcription Results -->
                    <div id="transcriptionSection" class="gux-transcription-section" style="display: none;">
                        <div class="gux-section-title">
                            <ion-icon name="language-outline"></ion-icon>
                            Transcription & Translation
                        </div>
                        
                        <!-- Loading State -->
                        <div id="transcriptionLoading" class="gux-transcription-loading">
                            <div class="gux-spinner"></div>
                            <p>Transcribing audio...</p>
                        </div>
                        
                        <!-- Results -->
                        <div id="transcriptionContent" class="gux-transcription-content" style="display: none;">
                            <div class="gux-transcription-box">
                                <div class="gux-transcription-header">
                                    <ion-icon name="mic-outline"></ion-icon>
                                    <span>Original (<span id="detectedLanguage">-</span>)</span>
                                </div>
                                <p id="originalText" class="gux-transcription-text"></p>
                            </div>
                            <div class="gux-transcription-box gux-translation">
                                <div class="gux-transcription-header">
                                    <ion-icon name="globe-outline"></ion-icon>
                                    <span>English Translation</span>
                                </div>
                                <p id="translatedText" class="gux-transcription-text"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Result Section (shown after audio is ready) -->
            <div id="resultSection" class="gux-result-section">
                <!-- Audio Player -->
                <div class="gux-section-title">
                    <ion-icon name="musical-notes-outline"></ion-icon>
                    Preview Audio
                </div>
                <div class="gux-audio-player">
                    <div id="waveform"></div>
                    <div class="gux-player-controls">
                        <button class="gux-play-btn" id="playBtn">
                            <ion-icon name="play" style="font-size: 1.5rem; margin-left: 3px;"></ion-icon>
                        </button>
                    </div>
                </div>

                <!-- Export Form -->
                <div class="gux-section-title">
                    <ion-icon name="cloud-done-outline"></ion-icon>
                    Export to Genesys Cloud
                </div>
                <div class="gux-export-card">
                    <div class="gux-grid-2">
                        <div class="gux-form-group">
                            <label class="gux-label">Prompt Name</label>
                            <input type="text" id="promptName" class="gux-input" placeholder="e.g. Welcome_Message_V1">
                        </div>
                        <div class="gux-form-group">
                            <label class="gux-label">Language Code</label>
                            <select id="promptLanguage" class="gux-select">
                                <optgroup label="English">
                                    <option value="en-us" selected>en-us (US)</option>
                                    <option value="en-gb">en-gb (UK)</option>
                                    <option value="en-au">en-au (Australia)</option>
                                </optgroup>
                                <optgroup label="German">
                                    <option value="de-de">de-de (Germany)</option>
                                    <option value="de-at">de-at (Austria)</option>
                                    <option value="de-ch">de-ch (Switzerland)</option>
                                </optgroup>
                                <optgroup label="French">
                                    <option value="fr-fr">fr-fr (France)</option>
                                    <option value="fr-ca">fr-ca (Canada)</option>
                                </optgroup>
                                <optgroup label="Spanish">
                                    <option value="es-es">es-es (Spain)</option>
                                    <option value="es-mx">es-mx (Mexico)</option>
                                </optgroup>
                                <optgroup label="Other">
                                    <option value="nl-nl">nl-nl (Dutch)</option>
                                    <option value="it-it">it-it (Italian)</option>
                                    <option value="pt-br">pt-br (Portuguese BR)</option>
                                    <option value="pl-pl">pl-pl (Polish)</option>
                                    <option value="ja-jp">ja-jp (Japanese)</option>
                                </optgroup>
                            </select>
                        </div>
                    </div>
                    <div class="gux-form-group">
                        <label class="gux-label">Description (Optional)</label>
                        <input type="text" id="promptDesc" class="gux-input"
                            placeholder="Brief description for this prompt">
                    </div>
                    <button class="gux-btn gux-btn-primary" id="exportBtn">
                        <span class="gux-spinner-inline"></span>
                        <ion-icon name="cloud-upload-outline"></ion-icon>
                        <span class="gux-btn-text">Export Prompt</span>
                    </button>
                    <div id="exportStatus" class="gux-status"></div>
                </div>
            </div>
        </div>
    </main>


    <!-- Footer -->
    <footer class="gux-footer">
        <p>© 2025 Prompt Studio 1.4.2 — Powered by <strong>Pilvi</strong></p>
    </footer>

    <!-- Wavesurfer.js -->
    <script src="https://unpkg.com/wavesurfer.js@7"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>

</html>